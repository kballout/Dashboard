doctype html
html(lang="en")
    head
        include ../../includes/header.pug
        include ../../includes/mixins
        script(src='/js/sidebar.js', defer)
        script(src='/js/guild.js', defer)
        link(rel='stylesheet', href='/css/sidebar.css')
        link(rel='stylesheet', href='/css/leaderboards.css')
        link(rel='stylesheet', href='/css/index.css')
        
    body
        if loggedIn
            include ../../includes/sidebar.pug

            #sidebarExtention.bf-light
                header.text-center.pt-4 
                    .large-icon.bg-white.round 
                        if guild.icon
                            img.round(src=guild.iconURL({dynamic: true, size: 128 }), alt = guild.name)
                        else
                            p.abbr #{guild.nameAcronym}
                    h4#overview.pt-2 #{guild.name}
                .tabs.navbar-nav
                    .category
                    a(href = '/servers/' + guild.id).cursor-pointer Overview
                    a(href ='/servers/' + guild.id + '/general').cursor-pointer #[i.fas.fa-cogs.ps-2.text-muted] General
                    a(href = '/servers/' + guild.id + '/moderation').cursor-pointer #[i.fas.fa-hammer.ps-2.text-muted] Moderation
                    a(href ='/servers/' + guild.id + '/management').cursor-pointer #[i.fas.fa-users-cog.ps-2.text-muted] Team Management
                    a(href = '/servers/' + guild.id + '/stores').cursor-pointer #[i.fas.fa-store-alt.ps-2.text-muted] Stores
                    a(href = '/servers/' + guild.id + '/programs').cursor-pointer #[i.fas.fa-hiking.ps-2.text-muted] Programs
                    a(href = '/servers/' + guild.id + '/stats').cursor-pointer #[i.fas.fa-chart-line.ps-2.text-muted] Stats

        include ../../includes/navbar.pug

        section#mainContent
            - var count
            - count = 0
            h1.display-5.text-center Leaderboards
            p.lead.text-center Check your server's leaderboards.
            hr.pt-1(style={'background-color': 'white', size: '0.45px', opacity: '1', width: '400px', 'margin-left': 'auto', 'margin-right': 'auto'})
            if !guildExists
                h3.text-center(style={'font-style': 'italic', color: 'red'}) Please initiate the server before attempting to change settings.
            else
                ul#pills-tab.nav.nav-pills.mb-3.justify-content-center(role='tablist')
                    li.nav-item(role='presentation')
                        button#pills-points-tab.nav-link.active(data-bs-toggle='pill', data-bs-target='#pills-points', type='button', role='tab', aria-controls='pills-points', aria-selected='true') Points
                    li.nav-item(role='presentation')
                        button#pills-rank-tab.nav-link(data-bs-toggle='pill', data-bs-target='#pills-rank', type='button', role='tab', aria-controls='pills-rank', aria-selected='false') Rank
                    li.nav-item(role='presentation')
                        button#pills-attendance-tab.nav-link(data-bs-toggle='pill', data-bs-target='#pills-attendance', type='button', role='tab', aria-controls='pills-attendance', aria-selected='false') Attendance
                    li.nav-item(role='presentation')
                        button#pills-exchange-tab.nav-link(data-bs-toggle='pill', data-bs-target='#pills-exchange', type='button', role='tab', aria-controls='pills-exchange', aria-selected='false') Exchange
                #pills-tabContent.tab-content
                    #pills-points.tab-pane.fade.show.active(role='tabpanel', aria-labelledby='pills-points-tab')
                        .row
                            .col-7
                                .container
                                    table.table.table-hover
                                        h2.text-center Top 10 of All Time
                                        thead
                                            tr
                                                th(scope='col') #
                                                th.col(scope='col') User
                                                th.col-4(scope='col') Points
                                        tbody 
                                            each user in usersByTotalPoints
                                                if count === 10
                                                    break
                                                -count++
                                                tr 
                                                    th(scope='row') #{count}
                                                    td 
                                                        img.round#avatar.me-3(src= user.avatarUrl, alt = user.username) 
                                                        span.ps-2 ##{user.discriminator}
                                                        span.ps-2 #{user.username} 
                                                    td #{user.totalPoints}
                            .col-5
                                -count = 0
                                .container
                                    table.table.table-hover
                                        h2.text-center Top 10 this Month
                                        thead
                                            tr
                                                th(scope='col') #
                                                th.col(scope='col') User
                                                th(scope='col') Points
                                        tbody 
                                            each user in usersByMonthlyPoints
                                                if count === 10
                                                    break
                                                -count++
                                                tr 
                                                    th(scope='row') #{count}
                                                    td 
                                                        img.round#avatar.me-3(src= user.avatarUrl, alt = user.username) 
                                                        span.ps-2 ##{user.discriminator}
                                                        span.ps-2 #{user.username} 
                                                    td #{user.monthlyPoints}
                            .col.mt-4
                                -count = 0
                                .container
                                    table.table.table-hover
                                        h2.text-center Top Currently
                                        thead
                                            tr
                                                th(scope='col') #
                                                th.col(scope='col') User
                                                th(scope='col') Points
                                        tbody 
                                            each user in usersByCurrentPoints
                                                -count++
                                                tr 
                                                    th(scope='row') #{count}
                                                    td 
                                                        img.round#avatar.me-3(src= user.avatarUrl, alt = user.username) 
                                                        span.ps-2 ##{user.discriminator}
                                                        span.ps-2 #{user.username} 
                                                    td #{user.currentPoints}
                    #pills-rank.tab-pane.fade(role='tabpanel', aria-labelledby='pills-rank-tab')
                        .row
                            .col
                                -count = 0
                                .container
                                    table.table.table-hover
                                        h2.text-center Top Users by Level
                                        thead
                                            tr
                                                th(scope='col') Rank #
                                                th.col(scope='col') User
                                                th.col-4(scope='col') Level
                                                th.col(scope='col') EXP
                                        tbody 
                                            each user in usersByLevel
                                                -count++
                                                tr 
                                                    th(scope='row') #{count}
                                                    td 
                                                        img.round#avatar.me-3(src= user.avatarUrl, alt = user.username) 
                                                        span.ps-2 ##{user.discriminator}
                                                        span.ps-2 #{user.username} 
                                                    td #{user.level}
                                                    td #{user.xp} / #{user.untilNextLevel}
                            .col-5
                                -count = 0
                                .container
                                    table.table.table-hover
                                        h2.text-center Top 10 who send Messages
                                        thead
                                            tr
                                                th(scope='col') #
                                                th.col(scope='col') User
                                                th(scope='col') Messages Sent
                                        tbody 
                                            each user in usersByMessages
                                                if count === 10
                                                    break
                                                -count++
                                                tr 
                                                    th(scope='row') #{count}
                                                    td 
                                                        img.round#avatar.me-3(src= user.avatarUrl, alt = user.username) 
                                                        span.ps-2 ##{user.discriminator}
                                                        span.ps-2 #{user.username} 
                                                    td.text-center #{user.messages}
                    #pills-attendance.tab-pane.fade(role='tabpanel', aria-labelledby='pills-attendance-tab')
                        .row
                            .col
                                -count = 0
                                .container
                                    table.table.table-hover
                                        h2.text-center Top Attendance of All Time
                                        thead
                                            tr
                                                th(scope='col') #
                                                th.col(scope='col') User
                                                th.col-4(scope='col') Sessions
                                        tbody 
                                            each user in usersByAttendance
                                                tr 
                                                    th(scope='row') #{count}
                                                    td 
                                                        img.round#avatar.me-3(src= user.avatarUrl, alt = user.username) 
                                                        span.ps-2 ##{user.discriminator}
                                                        span.ps-2 #{user.username} 
                                                    td #{user.attendance}
                            .col-5
                                -count = 0
                                .container
                                    table.table.table-hover
                                        h2.text-center Top 10 Users with the Highest Attendance Streaks
                                        thead
                                            tr
                                                th(scope='col') #
                                                th.col(scope='col') User
                                                th(scope='col') Streak
                                        tbody 
                                            each user in usersByHighestStreak
                                                if count === 10
                                                    break
                                                -count++
                                                tr 
                                                    th(scope='row') #{count}
                                                    td 
                                                        img.round#avatar.me-3(src= user.avatarUrl, alt = user.username) 
                                                        span.ps-2 ##{user.discriminator}
                                                        span.ps-2 #{user.username} 
                                                    td #{user.highestStreak}
                    #pills-exchange.tab-pane.fade(role='tabpanel', aria-labelledby='pills-exchange-tab')
                        .row
                            .col
                                -count = 0
                                .container
                                    table.table.table-hover
                                        h2.text-center Top 10 of All Time
                                        thead
                                            tr
                                                th(scope='col') #
                                                th.col(scope='col') User
                                                th.col-4(scope='col') Points Exchanged
                                        tbody 
                                            each user in usersByTotalExchange
                                                if count === 10
                                                    break
                                                -count++
                                                tr 
                                                    th(scope='row') #{count}
                                                    td 
                                                        img.round#avatar.me-3(src= user.avatarUrl, alt = user.username) 
                                                        span.ps-2 ##{user.discriminator}
                                                        span.ps-2 #{user.username} 
                                                    td #{user.totalExchange}
                            .col-5
                                -count = 0
                                .container
                                    table.table.table-hover
                                        h2.text-center Top 10 this Month
                                        thead
                                            tr
                                                th(scope='col') #
                                                th.col(scope='col') User
                                                th(scope='col') Points Exchanged
                                        tbody 
                                            each user in usersByMonthlyPoints
                                                if count === 10
                                                    break
                                                -count++
                                                tr 
                                                    th(scope='row') #{count}
                                                    td 
                                                        img.round#avatar.me-3(src= user.avatarUrl, alt = user.username) 
                                                        span.ps-2 ##{user.discriminator}
                                                        span.ps-2 #{user.username} 
                                                    td #{user.monthlyExchange}